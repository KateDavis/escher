<!doctype html><html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<link href="css/main.css" rel="stylesheet" type="text/css" />
		<title>Materializing circuits into reflexes</title>
	</head>
	<body>
	
	<div class="header">
	<a href="http://escher.io">Escher</a> A language for connecting technologies using pure metaphors
	</div>
	
	<div class="page">
	
<h1>Materializing</h1>

<ul>
<li><a href="#expanding">Expanding circuits</a></li>
<li><a href="#reflexes">Reflexes</a></li>
<li><a href="#links">Telescoping links</a></li>
<li><a href="#m">Materializing</a></li>
</ul>

<p><br>

<p>Escher's syntax is intended to facilitate manual codification of small circuits
by a human operator. In typical use cases, like for instance the codification of
datacenter service topologies, the graphs to be described are huge. To facilitate
building such graphs, Escher provides a mechanism for building out large complex
graphs modularly and recursively from smaller circuits.

<h2 id="expanding">Expanding circuits</h2>

<blockquote>
Expanding a source circuit is the process of substituting each address-valued gate
with a value found at the corresponding address within a <em>memory</em>, which is
a hierarchical namespace of values.
</blockquote>

<p>Consider the following input circuit:

<pre class="escher">
Employees {
	Manager gov.Eric
	Engineer Petar
	Project {
		Name "XData"
		Location Arlington
	}
	Manager:Supervises = Engineer:SupervisedBy
}
</pre>

<p>Here the gates <code>Engineer</code> and <code>Manager</code> have address values 
(<code>Petar</code> and <code>gov.Eric</code>, respectively).
Suppose further that circuits named <code>Eric</code> and <code>Petar</code> are
defined within an enclosing circuit <code>Memory</code> like so:

<pre class="escher">
Memory {
	gov {
		Eric {
			First "Eric"
			Last "Whyne"
		}
	}
	Petar {
		First "Petar"
		Last "Maymounkov"
		Home Brooklyn
		First:Lives = Home:
	}
	Brooklyn {
		Address "Brooklyn, NY"
	}
}
</pre>

<p><em>Expanding</em> the circuit <code>Employees</code>,
using the circuit <code>Memory</code> for lookup, is the process of
substituting every address gate value with the
respective value found in <code>Memory</code> at this address.
The result is called the <em>residue</em>.

<p>In our case, the residue would be:

<pre class="escher">
Employees {
	Manager {
		First "Eric"
		Last "Whyne"
	}
	Engineer {
		First "Petar"
		Last "Maymounkov"
		Home {
			Address "Brooklyn, NY"
		}
		First:Lives = Home:
	}
	Project {
		Name "XData"
		Location Arlington
	}
	Manager:Supervises = Engineer:SupervisedBy
}
</pre>

<p>Note that circuit links are also copied during expansion. Also note that
the address-valued gate <code>Location</code> in circuit <code>Project</code>
is not expanded, since <code>Project</code> is not the circuit being expandedâ€”<code>Employees</code> is.

<h2 id="links">Reflexes</h2>

<p>We would like to use circuits not merely to represent abstract data, but also
to help us connect and execute complex pipelines of independent processing units.

<p>We piggy-back the circuit expansion mechanism for this purpose.
Consider the following abstract circuit:


	<p><center>
	<figure class="shadowless">
		
	<table>
	<tr><td><object data="img/scanprint.svg" type="image/svg+xml" width="400px">
		<img src="img/scanprint.png" alt="" />
	</object></td><td>
	<pre class="escher">
	main {
		scanln os.Scanln
		println os.Println
		scanln:Read = println:Write
	}
	</pre>
	</td></tr>
	</table>
	
		<div><em>*</em></div>
	</figure>
	</center></p>
	

<h2 id="links">Telescoping links</h2>


	<p><center>
	<figure class="shadowless">
		
	<table>
	<tr><td><object data="img/telescope.svg" type="image/svg+xml" width="600px">
		<img src="img/telescope.png" alt="" />
	</object></td><td>
	<pre class="escher">
	Database {
		cache Cache
		left Shard
		right Shard
		link Link
		cache:Web = :Web
		left:Cache = cache:Left
		right:Cache = cache:Right
		left:Backup = link:Left
		right:Backup = link:Right
		link: = :Backup
	}
	App {
		web Web
		left Database
		right Database
		backup Backup
		left:Web = web:Left
		right:Web = web:Right
		left:Backup = backup:Left
		right:Backup = backup:Right
	}
	</pre>
	</td></tr>
	</table>
	
		<div><em>*</em></div>
	</figure>
	</center></p>
	

After ...


	<p><center>
	<figure class="shadowless">
		<object data="img/expanded.svg" type="image/svg+xml" width="500px">
		<img src="img/expanded.png" alt="" />
	</object>
		<div><em>*</em></div>
	</figure>
	</center></p>
	

Or....


	<p><center>
	<figure class="shadowless">
		<object data="img/flattened.svg" type="image/svg+xml" width="500px">
		<img src="img/flattened.png" alt="" />
	</object>
		<div><em>*</em></div>
	</figure>
	</center></p>
	

<p>We would like to use the mechanism of expanding circuits to build
large circuits from smaller ones. Roughly speaking, after expanding
a circuit program recursively, we want to flatten the resulting deep
circuit to get a depth-1 circuit that respects all gate and link structure of the
expanded design.

<p>

<h2 id="m">Materializing</h2>

<p>

        
	</div>
	
	<div class="footer">
	The <a href="http://escher.io">Escher</a> and <a href="http://gocircuit.org">Circuit</a> projects are
	partially supported by the 
	<a href="http://www.darpa.mil/Our_Work/I2O/Programs/XDATA.aspx">DARPA XData Initiative</a>.<br>
	Sponsors and partners are welcome and appreciated. Contact <a href="mailto:p@gocircuit.org">Petar Maymounkov</a> for details.
	</div>
	
	</body>
	</html>
	